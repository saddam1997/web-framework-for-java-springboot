/*!
 * @bndynet/angular-more v2.1.1 (https://github.com/BndyNet/angular-more#readme)
 * (c) 2014-2017 Bndy.Net (http://www.bndy.net)
 */

"use strict";angular.module("bn.ui",["ngSanitize","ui.bootstrap.datetimepicker","ui.dateTimeInput"]),angular.module("bn.ui").filter("appDate",function(){return function(a){return moment(a).isValid()?"zh-cn"===moment.locale()?moment(a).format("YYYY-M-D"):moment(a).format("l"):""}}).filter("appDateTime",function(){return function(a){return moment(a).isValid()?"zh-cn"===moment.locale()?moment(a).format("YYYY-M-D HH:mm:ss"):moment(a).format("lll"):""}}).filter("appFullDateTime",function(){return function(a){return moment(a).isValid()?(moment.locale(),moment(a).format("llll")):""}}),angular.module("bn.ui").directive("bnUiChecks",function(){return{restrict:"E",replace:!0,scope:{model:"=ngModel",label:"@",source:"=",multiple:"=?",withIcon:"=?",showButton:"=?"},template:'<div class="bn-ui-checks form-group">\n    <label ng-bind-html="label" ng-if="label"></label>\n    <div>\n        <div class="{{showButton ? \'btn-group\' : \'form-control-static\'}}">\n            <label ng-class="{\'btn btn-default\': showButton, \'active\': showButton && isExisted(value)}" ng-repeat="(key, value) in source"\n                ng-class="{active: isExisted(value)}" ng-click="select(value)">\n\n                <i class="glyphicon fa fa-fw {{multiple?\'glyphicon-check fa-check-square-o\':\'glyphicon-check fa-dot-circle-o\'}}" ng-show="isExisted(value) && showIcon()"></i>\n                <i class="glyphicon fa fa-fw {{multiple?\'glyphicon-unchecked fa-square-o\':\'glyphicon-unchecked fa-circle-o\'}}" ng-show="!isExisted(value) && showIcon()"></i>\n                <span ng-bind="key"></span>\n            </label>\n        </div>\n    </div>\n</div>',link:function(a,b,c){return!a.model&&a.multiple&&(a.model=[]),void 0===a.multiple&&(a.multiple=!1),void 0===a.withIcon&&(a.withIcon=!1),a.showIcon=function(){return void 0!==a.withIcon&&a.withIcon},a.isExisted=function(b){return void 0!==a.model&&(a.multiple?a.model.indexOf(b)>=0:b.toString()===a.model.toString())},a.select=function(b){return a.multiple?a.model.indexOf(b)<0?a.model.push(b):a.model.splice(a.model.indexOf(b),1):a.model=b}}}}),angular.module("bn.ui").directive("bnUiColorpicker",function(){return{restrict:"E",replace:!0,scope:{ngColors:"=ngColors",ngModel:"=ngModel",onChange:"&onChange"},template:'<span class="bn-ui-colorpicker dropdown">\n  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="false">\n      <span class="empty" ng-show="ngModel == null || typeof(ngModel) == \'undefined\'"></span>\n      <span ng-style="{\'background-color\': color.value}" ng-class="color.css" ng-show="color.key == ngModel" ng-repeat="color in ngColors" title="{{color.description}}"></span>\n  </a>\n  <ul class="dropdown-menu" ng-class="{inline: inline}">\n      <li ng-repeat="color in ngColors">\n          <a role="button" ng-click="onChange({color: color})">\n              <span class="flag" style="" ng-class="color.css" ng-style="{\'background-color\': color.value}"></span>\n              <span ng-bind="color.description"></span>\n          </a>\n      </li>\n  </ul>\n</span>',link:function(a,b,c){var d,e,f,g,h;for(f=!0,h=a.ngColors,e=0,g=h.length;e<g;e++)if(d=h[e],d.description){f=!1;break}a.inline=f}}}),angular.module("bn.ui").directive("bnUiInput",[function(){return{restrict:"E",replace:!0,transclude:!0,require:"ngModel",scope:{ngModel:"=ngModel",label:"@label",addon:"@addon",type:"@type",format:"@format"},template:'<div class="bn-ui-input form-group">\n    <label ng-bind-html="label" ng-if="label"></label>\n    <div class="dropdown" ng-if="type==\'datetime\'||type==\'date\'">\n        <a class="dropdown-toggle" id="btn_{{tagId}}" role="button" data-toggle="dropdown" data-target="#" href="#">\n            <div class="input-group">\n                <input type="text" class="form-control" data-ng-model="ngModel" data-date-time-input="{{format}}" readonly>\n                <span class="input-group-addon">\n                    <i class="glyphicon glyphicon-calendar fa fa-calendar"></i>\n                </span>\n            </div>\n        </a>\n        <ul class="dropdown-menu" role="menu" aria-labelledby="dLabel">\n            <datetimepicker data-ng-model="ngModel" \n                data-on-set-time="onTimeSet(newDate, oldDate)"\n                data-datetimepicker-config="{ dropdownSelector: \'#btn_\' + tagId, startView:\'day\', minView: type==\'date\' ? \'day\' : \'minute\' }" />\n        </ul>\n    </div>\n    <div class="{{addon?\'input-group\':\'\'}}" ng-if="type!=\'datetime\'&&type!=\'date\'">\n        <input type="{{type}}" class="form-control" ng-model="ngModel" />\n        <div class="input-group-addon" ng-if="addon" ng-bind-html="addon"></div>\n    </div>\n</div>',controller:["$scope","$element","$transclude",function(a,b,c){return a.tagId=parseInt(1e6*Math.random()),c(function(b){var c,d,e,f;for(d=0,f=b.length;d<f;d++)e=b[d],"ADDON"===e.tagName&&(c=e);c&&(a.addon=c.innerHTML)})}],compile:function(a,b,c){if(""===b.required||"true"===b.required)return a.find("input").attr("required",!0)}}}]),angular.module("bn.ui").directive("bnUiPager",function(){return{restrict:"E",template:'<div class="bn-ui-pager" ng-show="model.recordCount > 0">\n    <div class="summary" ng-show="showSummary">\n        <span ng-bind="(model.currentPage - 1) * model.pageSize + 1"></span>\n        - <span ng-bind="model.currentPage * model.pageSize > model.recordCount ? model.recordCount : model.currentPage * model.pageSize"></span>\n        / <span ng-bind="model.recordCount"></span>\n    </div>\n    <nav aria-label="Page navigation">\n      <ul class="pagination" ng-show="model.pageCount > 1">\n        <li ng-class="{disabled: model.currentPage == 1}">\n          <a aria-label="Previous" ng-click="page(model.currentPage-1)">\n            <span aria-hidden="true">&laquo;</span>\n          </a>\n        </li>\n        <li ng-repeat="p in model.displayPageNumbers track by $index" ng-class="{active: model.currentPage == p, disabled: p < 0}">\n          <a ng-show="p > 0" ng-click="page(p)"><span ng-bind="p"></span></a>\n          <a ng-show="p < 0">...</a>\n        </li>\n        <li ng-class="{disabled: model.currentPage == model.pageCount}">\n          <a aria-label="Next" ng-click="page(model.currentPage+1)">\n            <span aria-hidden="true">&raquo;</span>\n          </a>\n        </li>\n      </ul>\n    </nav>\n</div>',replace:!0,scope:{model:"=ngModel",onPage:"&onPage"},link:function(a,b,c){void 0===a.model&&(a.model={}),a.showSummary=void 0===c.showSummary||"true"===c.showSummary,a.$watch("model",function(b,c){var d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y;if(b&&(void 0===a.model.pageCount&&(a.model.pageCount=Math.ceil(a.model.recordCount/a.model.pageSize)),void 0===a.model.displayPageNumbers))if(a.model.displayPageNumbers=[],a.model.pageCount<=10)for(m=d=1,o=a.model.pageCount;1<=o?d<=o:d>=o;m=1<=o?++d:--d)a.model.displayPageNumbers.push(m);else if(a.model.currentPage<=5){for(m=e=1;e<=7;m=++e)a.model.displayPageNumbers.push(m);for(a.model.displayPageNumbers.push(-1),m=f=p=a.model.pageCount-1,r=a.model.pageCount;p<=r?f<=r:f>=r;m=p<=r?++f:--f)a.model.displayPageNumbers.push(m)}else if(a.model.currentPage>a.model.pageCount-5){for(s=[1,2],g=0,h=s.length;g<h;g++)m=s[g],a.model.displayPageNumbers.push(m);for(a.model.displayPageNumbers.push(-1),m=j=t=a.model.pageCount-6,u=a.model.pageCount;t<=u?j<=u:j>=u;m=t<=u?++j:--j)a.model.displayPageNumbers.push(m)}else{for(v=[1,2],k=0,i=v.length;k<i;k++)m=v[k],a.model.displayPageNumbers.push(m);for(a.model.displayPageNumbers.push(-1),m=l=w=a.model.currentPage-2,x=a.model.currentPage+2;w<=x?l<=x:l>=x;m=w<=x?++l:--l)a.model.displayPageNumbers.push(m);for(a.model.displayPageNumbers.push(-1),m=n=y=a.model.pageCount-1,q=a.model.pageCount;y<=q?n<=q:n>=q;m=y<=q?++n:--n)a.model.displayPageNumbers.push(m)}}),a.page=function(b){b<=0&&(b=1),b>a.model.pageCount&&(b=a.model.pageCount),a.model.currentPage!==b&&(a.onPage&&a.onPage({page:b}),a.model.currentPage=b)}}}}),angular.module("bn.ui").directive("bnUiSearch",[function(){return{restrict:"E",replace:!0,scope:{model:"=ngModel",placeholder:"@"},template:'<div class="bn-ui-search">\n    <i class="glyphicon glyphicon-search fa fa-search"></i>\n    <input type="text" ng-model="model" class="form-control" placeholder="{{placeholder}}" />\n    <span class="ng-cloak" role="button" ng-show="model" ng-click="model=null">&times;</span>\n</div>'}}]),angular.module("bn.ui").directive("bnUiSelect",[function(){return{restrict:"E",replace:!0,scope:{model:"=ngModel",source:"=",label:"@"},template:'<div class="bn-ui-select form-group">\n    <label ng-bind-html="label" ng-if="label"></label>\n    <select ng-model="model" class="form-control">\n        <option value="{{value}}" ng-bind="key" ng-repeat="(key, value) in source"></option>\n    </select>\n</div>'}}]),angular.module("bn.ui").directive("bnUiSwitch",[function(){return{restrict:"E",replace:!0,scope:{model:"=ngModel",onChange:"&onChange"},template:'<span class="bn-ui-switch" ng-class="{on: model}" ng-click="change();">\n    <span class="indicator"></span>\n</span>',link:function(a,b,c){return a.change=function(){if(a.model=!a.model,angular.isFunction(a.onChange))return a.onChange({value:a.model})}}}}]),angular.module("bn.ui").directive("bnFillHeight",[function(){return{restrict:"A",link:function(a,b,c){return b.css("height",b.parent().height())}}}]);
